package application;

import com.jfoenix.controls.JFXComboBox;
import com.jfoenix.controls.JFXDatePicker;

import javafx.collections.FXCollections;
import javafx.collections.ObservableList;
import javafx.fxml.FXML;
import javafx.scene.control.TableView;
import javafx.scene.control.TextArea;
import javafx.scene.control.TextField;
import javafx.scene.control.cell.PropertyValueFactory;
import javafx.stage.Stage;

public class CreateEventController extends MainWindowController {
	
	@FXML private TextField eventNameField;
	@FXML private JFXComboBox<String> eventLocationField;
	@FXML private JFXDatePicker eventStartDateField;
	@FXML private JFXDatePicker eventStartTimeField;
	@FXML private JFXDatePicker eventEndDateField;
	@FXML private JFXDatePicker eventEndTimeField;
	@FXML private TextArea eventInfoField;
	@FXML private TextArea eventTCField;

	private Main main;
	private Stage stage;
	
	public void setMain(Main main, Stage stage){
		this.main = main;
		this.stage = stage;
	}
	
	public static ObservableList<Venue> venueData = FXCollections.observableArrayList();
	public static ObservableList<Venue> getVenueData() { return venueData; }
	
	public void initialize(){

		JFXComboBox<String> comboBox = new JFXComboBox();
		Datasource datasource = new Datasource();
		venueData =  datasource.queryVenues();
		eventLocationField.setCellFactory(venueData, );
	}
	
	@FXML
	public void handleCreateEvent(){
		Event event = new Event();
		event.setEventName(eventNameField.getText());
		
		String eventSD = eventStartDateField.getValue().toString();
		String eventST = eventStartTimeField.getTime().toString();
		String eventET = eventEndTimeField.getTime().toString();
		String eventED = eventEndDateField.getValue().toString();
		
		event.setEventStartDateTime(eventSD + " " + eventST);	
		event.setEventEndDateTime(eventED + " " + eventET);
		event.setEventInfo(eventInfoField.getText());
		event.setEventTC(eventTCField.getText());
		event.setVenueName(eventLocationField.getAccessibleText());
		Datasource datasource = new Datasource();
		datasource.open();
		datasource.insertEvent(event);
		stage.close();
	}
	
}